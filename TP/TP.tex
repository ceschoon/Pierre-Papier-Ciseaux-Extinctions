\documentclass[openany,a4paper,12pt]{article}
\input{settings/packages}

%% TITLE
\title{
\textsc{Travail personnel}\\ 
Processus Stochastiques en Physique\\
PHYS-F446\\
\rule{\linewidth}{1pt} \\
\vspace{3mm}
Extinctions dans un modèle de prédation cyclique \\
de type "pierre papier ciseaux"\\
\rule{\linewidth}{1pt}
}
\author{Cédric \textsc{Schoonen}}

%% BIBLIOGRAPHY
\input{settings/bibliography}
\bibliography{literature/library}

%% OTHER
\usepackage{tocloft}
\setlength\cftparskip{-1mm}
%\setlength\cftbeforechapskip{0pt}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\begin{document}

\maketitle
\vspace{1cm}

\tableofcontents

\newpage

%%%%%%%%%%% Plan %%%%%%%%%%%

% Présentation du système 
%   "eq chimiques" 
% Dynamique macroscopique (déterministe)
%   equations dynamique macroscopique
%   portrait de phase
%   invariants
%   bihamiltonien ??
% Dynamique microscopique (stochastique)
%   eq maitresse
%   dev de Kramers-Moyal et eq Fokker-Planck (!echelle de temps!)
%   SDE
%   croissance moyenne du second invariant ??
% Réduction à un processus radial
%   changmt var pour rho
%   stochastic averaging
%   SDE 1D
%   calcul numérique de D(rho)
% Problème d'échappement région 1D
%   dév section 5.2 Gardiner
% Temps moyens d'extinction (processus radial)
%   application formules d'échappement au temps d'extinction
%   intégrations numériques
%   résultats, comparaison interp-approx-simul
% Simulation du système
%   méthode avec algo gillespie
%   trajectoire dans portrait de phase
%   résultats pour plusieurs espèces ??

%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\section{Présentation du modèle étudié}

\par Dans ce travail, nous nous intéressons à un modèle de prédation de type "pierre papier ciseaux". Dans ce modèle, trois espèces $A,B,C$ cohabitent et forment un réseau de prédation cyclique. Nous pouvons représenter les interactions du modèles par les réactions
%
\begin{equation}\label{reactions_k}
\begin{split}
	A + B & \overset{k}{\longrightarrow} 2A, \\
	B + C & \overset{k}{\longrightarrow} 2B, \\
	C + A & \overset{k}{\longrightarrow} 2C, 
\end{split}
\end{equation}
%
où le paramètre $k$ est la fréquence des interactions entre deux individus. Le nombre total d'individus $N=A+B+C$ est conservé dans cette dynamique. Nous avons ici symbolisé le nombre d'individus de chanque espèce par le même symbole $A,B$ ou $C$ employé pour désigner l'espèce.



\section{Dynamique macroscopique}

\par Dans limite macroscopique, i.e. $N\rightarrow \infty$, le système obéit aux équations dynamiques {\color{red}montrer limite eq maîtresse/FP ?}
%
\begin{equation}\label{dyn_macro}
\begin{split}
	\dot a &= ka(b-c), \\
	\dot b &= kb(c-a), \\
	\dot c &= kc(a-b),
\end{split}
\end{equation}
%
où nous avons noté en lettre minuscule la fraction d'individus de chaque espèce, i.e. $a=A/N$. La conservation du nombre d'individus montre que l'espace des phases est contenu dans le plan: $a+b+c=1$. Les trajectoires engendrées par les équations \ref{dyn_macro} sont représentées sur la figure {\color{red}figure}.

\par La dynamique macroscopique possède deux invariants, ce qui le rend intégrable exactement. Le premier est trivial et est donné par la loi de conservation $a+b+c=1$. Le second est le produit $\rho = abc$, en effet
%
\begin{equation}\label{rho_invariant}
\begin{split}
	\frac{\dd \rho}{\dd t} 
	&= \dot a bc + a \dot b c + ab \dot c \\
	&= ka(b-c) + kb(c-a) + kc(a-b) \\
	&= 0
\end{split}
\end{equation}
%

{\color{red} Généralisation d espèces}

{\color{red} Deux hamiltoniens H0 et H1 ??}


\section{Dynamiques micro et mésoscopiques}

\par La dynamique microscopique est un processus de Markov pour lequel un état du système $\{A,B,C\}$ subit les transitions 
%
\begin{equation}\label{dyn_micro}
\begin{split}
	\{A,B,C\} &\longrightarrow \{A+1,B-1,C\}  \qquad \text{fréquence = } k\, AB, \\
	\{A,B,C\} &\longrightarrow \{A,B+1,C-1\}  \qquad \text{fréquence = } k\, BC, \\
	\{A,B,C\} &\longrightarrow \{A-1,B,C+1\}  \qquad \text{fréquence = } k\, CA.
\end{split}
\end{equation}
%
L'équation maîtresse associée est 
%
\begin{equation}\label{eq_maitresse}
\begin{split}
	\frac{\dd}{\dd t}\, P_t(A,B,C) 
	&= k\, (A-1)(B+1)\, P_t(A-1,B+1,C) - k\, AB\, P_t(A,B,C) \\
	{\color{white}\frac{\dd}{\dd t}} % for uniform spacing
	&+ k\, (B-1)(C+1)\, P_t(A,B-1,C+1) - k\, BC\, P_t(A,B,C) \\
	{\color{white}\frac{\dd}{\dd t}} % for uniform spacing
	&+ k\, (C-1)(A+1)\, P_t(A+1,B,C-1) - k\, CA\, P_t(A,B,C).
\end{split}
\end{equation}


\par En développant l'équation maîtresse en puissances de $\epsilon = 1/N$, on déduit l'équation de Fokker-Planck 
%
\begin{equation}\label{eq_FP}
	\partial_t \Psi_t = - \partial_i ( \mu_i \Psi_t ) + \partial_i\partial_j (D_{ij} \Psi_t),
\end{equation}
%
où $\Psi_t(a,b,c)$ est la densité de probabilité pour les fractions $a,b,c$,
%
\begin{equation}\label{lien_psi_proba}
	\Psi_t(a,b,c) = N^3 P_t(A,B,C) = \epsilon^{-3} P_t(a/\epsilon, b/\epsilon, c/\epsilon).
\end{equation}

\par Cette équation décrit la dynamique du système à une échelle intermédiaire, que l'on pourrait qualifier de "mésoscopique". L'équation de Fokker-Planck s'obtient dans la limite de grand $N$, mais nous gardons encore des puissances de $1/N$ dans le terme de diffusion. Cette description garde donc le caractère aléatoire des trajectoires microscopiques. Ce niveau de description est approprié pour étudier des phénomènes d'origine stochastique, comme l'extinction d'une des espèces du modèle, en ayant la possibilité d'employer les outils de calcul différentiel, qui s'appliquent à une description en variables continues.

{\color{red} pas meme temps} 

\par Les quantités $\mu_i$ et $D_{ij}$ sont respectivement les vecteurs de dérive et la matrice de diffusion. Le vecteur de dérive est donné par 
%
\begin{equation}\label{mu_i_expr}
	\boldsymbol\mu^T = 
	\begin{bmatrix} a(b-c) & b(c-a) & c(a-b) \end{bmatrix}
\end{equation}
%
et la matrice de diffusion est
%
\begin{equation}\label{D_ij_expr}
	\bold D = \frac{\epsilon}{2}
	\begin{bmatrix}
	a(b+c) & -ab & -ac \\
	-ab & b(c+a) & -bc \\
	-ac & -bc & c(a+b)
	\end{bmatrix}.
\end{equation}
%

\par L'équation différentielle stochastique associée est, selon la convention de Itô,
%
\begin{equation}\label{SDE_abc}
	\dd \bold r_t = \boldsymbol \mu (\bold r_t) \, \dd t + \boldsymbol \sigma(\bold r_t) \, \dd \bold W_t,
\end{equation}
où $\bold r_t = (a,b,c)$, $\bold D = \frac 12 \boldsymbol \sigma \boldsymbol \sigma^T$, et $\bold W_t$ est un processus de Wien de moyenne nulle et de variance unité.


\section{Développement de Kramers-Moyal de l'équation maîtresse}

\par On commence par exprimer l'équation maîtresse (eq \ref{eq_maitresse}) avec les variables "mésoscopiques" $\Psi_t$, $a,b,c$ et $\epsilon=1/N$. On obtient
%
\begin{equation}\label{eq_maitresse_minuscules}
\begin{split}
	\epsilon ^3 \partial_t \Psi_t(a,b,c) 
	&= k \left( \frac a \epsilon - 1 \right) \left( \frac b \epsilon + 1\right)  \, \epsilon^3 \Psi_t(a-\epsilon, b+\epsilon, c) \\
	&- k\, \frac a \epsilon \frac b \epsilon \, \epsilon^3 \Psi_t(a,b,c) + p.c. \,\, ,
\end{split}
\end{equation}
%
où nous avons symbolisé par $p.c.$ les termes issus de permutations cycliques par rapport à $a,b,c$ dans les termes déjà notés. Cette équation peut être réarrangée en
%
\begin{equation}\label{eq_maitresse_minuscules_clean}
\begin{split}
	\frac{\epsilon^2}{k}\, \partial_t \Psi_t(a,b,c) 
	&= (a-\epsilon)(b+\epsilon)  \, \Psi_t(a-\epsilon, b+\epsilon, c) 
	- ab \, \Psi_t(a,b,c) + p.c. \,\, .
\end{split}
\end{equation}
%

\par On développe ensuite en puissance de $\epsilon$, en ne gardant que les termes d'ordre inférieur ou égal à deux. On commence par développer le produit $(a-\epsilon)(b+\epsilon)$,
%
\begin{equation}\label{moyal_dev_epsilon_produit}
\begin{split}
	\frac{\epsilon^2}{k}\, \partial_t \Psi_t(a,b,c) 
	&= ab \, \Psi_t(a-\epsilon, b+\epsilon, c) + (a-b)\epsilon \, \Psi_t(a-\epsilon, b+\epsilon, c) \\
	&\quad - \epsilon^2 \, \Psi_t(a-\epsilon, b+\epsilon, c) - ab \, \Psi_t(a, b, c) + p.c.
\end{split}
\end{equation}
%
Ensuite, on développe les densités de probabilité en série de Taylor,
%
\begin{equation}\label{moyal_dev_epsilon_taylor}
\begin{split}
	\frac{\epsilon^2}{k}\, \partial_t \Psi_t(a,b,c) 
	&= \cancel{ab \, \Psi_t(a, b, c)} 
	- {\color{purple} ab \, \epsilon \, \partial_a \Psi_t(a,b,c) }
	+ {\color{purple} ab \, \epsilon \, \partial_b \Psi_t(a,b,c) }\\
	{\color{white} \frac{\epsilon^2}{k} } % for uniform spacing
	&\quad + {\color{blue} \frac{\epsilon^2}{2} \, \partial_a^2 \Psi_t(a,b,c) }
	+ {\color{blue} \frac{\epsilon^2}{2} \, \partial_b^2 \Psi_t(a,b,c) }
	+ {\color{blue} \epsilon^2 \, \partial_a \partial_b \Psi_t(a,b,c) }\\
	{\color{white} \frac{\epsilon^2}{k} } % for uniform spacing  
	&\quad + \cancel{\color{brown} (a-b) \,\epsilon \, \Psi_t(a, b, c) }
	- {\color{cyan} (a-b) \,\epsilon^2 \, \partial_a \Psi_t(a,b,c) }\\
	{\color{white} \frac{\epsilon^2}{k} } % for uniform spacing
	&\quad + {\color{cyan} (a-b) \,\epsilon^2 \, \partial_b \Psi_t(a,b,c) } 
	- {\color{green!60!black} \epsilon^2 \, \Psi_t(a, b, c) } 
	- \cancel{ab \, \Psi_t(a, b, c)} \\
	&\quad + p.c.
\end{split}
\end{equation}
%
Remarquons que le terme coloré en brun s'annule avec ses homologues issus des permutations cycliques en $a,b,c$. 

\par La dernière étape consiste à redéfinir l'échelle de temps en absorbant $\epsilon$ et $k$ dans $t$, de sorte que 
%
\begin{equation}\label{moyal_redef_temps}
	\frac{k}{\epsilon} \, t \rightarrow t,
\end{equation}
%
nous obtenons ainsi 
%
\begin{equation}\label{moyal_dev_epsilon_complet}
\begin{split}
	\partial_t \Psi_t(a,b,c) 
	&= {\color{purple} ab \, \partial_a \Psi_t(a,b,c) }
	+ {\color{purple} ab \, \partial_b \Psi_t(a,b,c) }\\
	&\quad + {\color{blue} \frac{\epsilon}{2} \, \partial_a^2 \Psi_t(a,b,c) }
	+ {\color{blue} \frac{\epsilon}{2} \, \partial_b^2 \Psi_t(a,b,c) }
	+ {\color{blue} \epsilon \, \partial_a \partial_b \Psi_t(a,b,c) }\\
	&\quad - {\color{cyan} (a-b) \,\epsilon \, \partial_a \Psi_t(a,b,c) }
	+ {\color{cyan} (a-b) \,\epsilon \, \partial_b \Psi_t(a,b,c) } \\
	&\quad- {\color{green!60!black} \epsilon \, \Psi_t(a, b, c) } 
	+ p.c.
\end{split}
\end{equation}
%

\par Pour voir que ce développement mène à l'équation de Fokker-Planck (eq \ref{eq_FP}), il est plus facile de partir de cette dernière équation et développer les expressions de $\mu_i$ et $D_{ij}$. Cela donne
%
\begin{equation}\label{moyal_dev_eq_FP}
\begin{split}
	\partial_t \Psi_t
	&= - \partial_i \mu_i \, \Psi_t
	- {\color{purple} \mu_i \, \partial_i \Psi_t }
	+ {\color{green!60!black} \partial_i\partial_j D_{ij} \, \Psi_t }
	+ {\color{cyan} 2 \partial_i D_{ij} \, \partial_j \Psi_t }
	+ {\color{blue} D_{ij} \,  \partial_i\partial_j \Psi_t } \\
	&= - \cancel{(b-c) \, \Psi_t} - \cancel{p.c.}
	%- \cancel{(c-a) \, \Psi_t}
	%- \cancel{(a-b) \, \Psi_t} \\
	- {\color{purple} a(b-c)\, \partial_a \Psi_t }
	- {\color{purple} p.c. }
	%- {\color{purple} b(c-a)\, \partial_b \Psi_t }
	%- {\color{purple} c(a-b)\, \partial_c \Psi_t } \\
	+ {\color{green!60!black} \frac \epsilon 2 \, [0-\Psi_t-\Psi_t] }
	+ {\color{green!60!black} p.c. } \\
	&\quad + {\color{cyan} \epsilon \, [ (b+c) \, \partial_a \Psi_t - b \, \partial_b \Psi_t - c \, \partial_c \Psi_t ] }
	+ {\color{cyan} p.c. } \\
	&\quad + {\color{blue} \frac \epsilon 2 \, [ a(b+c) \, \partial_a^2 \Psi_t - ab \, \partial_a\partial_b \Psi_t - ac \, \partial_a\partial_c \Psi_t ] }
	+ {\color{blue} p.c. }
\end{split} 
\end{equation}
%
La correspondance entre les termes violets, vert et bleus des équations \ref{moyal_redef_temps} et \ref{moyal_dev_eq_FP} est assez facile à voir, en tenant compte des permutations cycliques. Pour les termes cyan, il faut employer la relation de conservation $a+b+c=1$. Par example, les termes en $\partial_a\Psi_t$ dans l'équation \ref{moyal_dev_eq_FP} peuvent être écrits comme
%
\begin{equation}\label{moyal_terme_cyan_corresp}
	\epsilon\, (b+c)\, \partial_a\Psi_t -2\epsilon\, a\, \partial_a\Psi_t = \epsilon\, (b-a)\, \partial_a\Psi_t + \epsilon\, (c-a)\, \partial_a\Psi_t.
\end{equation}
%

{\color{red} dev termes cyan pour mieux voir}

\section{Réduction à un processus radial}

\section{Problème d'échappement d'un intervalle}

\section{Temps moyen d'extinction}

\section{Simulation du système}


%\begin{figure}
%	\centering
%	\begin{subfigure}{.33\textwidth}
%		\centering
%		\includegraphics[width=\linewidth]{figures/p2_avant_bp}
%		\caption{}
%	\end{subfigure}%
%	\begin{subfigure}{.33\textwidth}
%		\centering
%		\includegraphics[width=\linewidth]{figures/p2_1bp1}
%		\caption{}
%	\end{subfigure}%
%	\begin{subfigure}{.33\textwidth}
%		\centering
%		\includegraphics[width=\linewidth]{figures/p2_1bp2}
%		\caption{}
%	\end{subfigure}
%	\caption{Représentation graphique des actions des deux applications $b_p$ obtenues à la question 2.3. La figure (a) représente les points du carré unité avant l'action des $b_p$, la figure (b) les même points après l'action de l'application préservant les aires et la figure (c) indique l'action de l'application ne préservant pas les aires.}
%	\label{fig:p2-graphesbp}
%\end{figure}

		
\printbibliography

\end{document} 

